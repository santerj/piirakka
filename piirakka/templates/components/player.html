<div class="navbar w-full bg-gray-50 rounded-lg border border-gray-300 shadow-lg">
    <div class="navbar-start">
        <!-- <h2 class="font-nunito ml-2" id="nowPlaying">now playing: <span id="currentStation"></span></h2>> -->
        {% include 'components/now_playing_display.html' %}
    </div>

    <!-- middle button controls  -->
    <div class="navbar-center flex space-x-5">
        <!-- Play/Pause Button -->
        <!-- TODO: replace js with swap component https://daisyui.com/components/swap/ -->
        <button 
            id="playPauseButton" 
            class="btn bg-white hover:bg-white border shadow-md hover:shadow-inner" 
            onclick="handleToggle()">
            <!-- TODO: icon state only set on initial render, needs to reflect websocket events -->
            <img id="playIcon" src="static/icons/play-circle-line.svg" alt="Play" class="h-6 w-6 {% if playing %}hidden{% endif %}">
            <img id="pauseIcon" src="static/icons/pause-circle-line.svg" alt="Pause" class="h-6 w-6 {% if not playing %}hidden{% endif %}">
        </button>

        <!-- Shuffle Button -->
        <button 
            id="shuffleButton" 
            class="btn bg-white hover:bg-white border shadow-md hover:shadow-inner" 
            onclick="handleShuffle()">
            <img src="static/icons/shuffle-line.svg" alt="Shuffle" class="h-6 w-6">
        </button>

        <!-- Volume Button -->
        <!-- TODO: replace js with swap component https://daisyui.com/components/swap/ -->
        <!-- TODO: needs to reflect websocket events -->
        <button 
            id="volumeButton" 
            class="btn bg-white hover:bg-white border shadow-md hover:shadow-inner" 
            onclick="handleVolumeToggle()">
            <img id="volumeUpIcon" src="static/icons/volume-up-line.svg" alt="Volume Up" class="h-6 w-6">
            <img id="volumeMuteIcon" src="static/icons/volume-mute-line.svg" alt="Mute" class="h-6 w-6 hidden">
        </button>
    </div>

    <div class="navbar-end">
        <!-- Volume Control -->
        <i class="fa fa-volume-up"></i>
        <input 
            type="range"
            value="{{ volume }}" 
            min="0"
            max="100"
            step="1"
            class="range range-xs mr-2"
            style="max-width: 180px;" 
            id="volumeControl" 
            onchange="handleVolumeChange(this.value)">
    </div>
</div>

<script>
  // JavaScript to handle play/pause button
  function handleToggle() {
      const playIcon = document.getElementById('playIcon');
      const pauseIcon = document.getElementById('pauseIcon');

      if (playIcon.classList.contains('hidden')) {
          playIcon.classList.remove('hidden');
          pauseIcon.classList.add('hidden');
      } else {
          playIcon.classList.add('hidden');
          pauseIcon.classList.remove('hidden');
      }

      fetch('/api/radio/toggle', {
          method: 'PUT'
      });
  }

  // JavaScript to handle shuffle button
  function handleShuffle() {
      fetch('/shuffle', {
          method: 'POST'
      });
  }

  // JavaScript to handle volume toggle button
  function handleVolumeToggle() {
      const volumeControl = document.getElementById('volumeControl');
      const volumeUpIcon = document.getElementById('volumeUpIcon');
      const volumeMuteIcon = document.getElementById('volumeMuteIcon');

      if (volumeUpIcon.classList.contains('hidden')) {
          volumeUpIcon.classList.remove('hidden');
          volumeMuteIcon.classList.add('hidden');
          volumeControl.value = 50;  // Reset to some default volume when unmuted
      } else {
          volumeUpIcon.classList.add('hidden');
          volumeMuteIcon.classList.remove('hidden');
          volumeControl.value = 0;  // Mute
      }

      handleVolumeChange(volumeControl.value);  // Update volume on toggle
  }

  // JavaScript to handle volume change
  function handleVolumeChange(value) {
      fetch('/api/radio/volume', {
          method: 'PUT',
          headers: {
              'Content-Type': 'application/json'
          },
          body: JSON.stringify({ volume: value })
      });
  }

  // set currently playing station
  function setCurrentStation(value) {
      document.getElementById('currentStation').textContent = value;
  }
</script>
